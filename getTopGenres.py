# json path track.id

# example of response of getFavoriteTracks :
# [{"added_at": "2024-02-12T15:57:33Z", "track": {"album": {"album_type": "album", "artists": [{"external_urls": {"spotify": "https://open.spotify.com/artist/48cu2msOlKJZfmTxeYLkuZ"}, "href": "https://api.spotify.com/v1/artists/48cu2msOlKJZfmTxeYLkuZ", "id": "48cu2msOlKJZfmTxeYLkuZ", "name": "ACHIM", "type": "artist", "uri": "spotify:artist:48cu2msOlKJZfmTxeYLkuZ"}], "available_markets": ["AR", "AU", "AT", "BE", "BO", "BR", "BG", "CA", "CL", "CO", "CR", "CY", "CZ", "DK", "DO", "DE", "EC", "EE", "SV", "FI", "FR", "GR", "GT", "HN", "HK", "HU", "IS", "IE", "IT", "LV", "LT", "LU", "MY", "MT", "MX", "NL", "NZ", "NI", "NO", "PA", "PY", "PE", "PH", "PL", "PT", "SG", "SK", "ES", "SE", "CH", "TW", "TR", "UY", "US", "GB", "AD", "LI", "MC", "ID", "JP", "TH", "VN", "RO", "IL", "ZA", "SA", "AE", "BH", "QA", "OM", "KW", "EG", "MA", "DZ", "TN", "LB", "JO", "PS", "IN", "BY", "KZ", "MD", "UA", "AL", "BA", "HR", "ME", "MK", "RS", "SI", "KR", "BD", "PK", "LK", "GH", "KE", "NG", "TZ", "UG", "AG", "AM", "BS", "BB", "BZ", "BT", "BW", "BF", "CV", "CW", "DM", "FJ", "GM", "GE", "GD", "GW", "GY", "HT", "JM", "KI", "LS", "LR", "MW", "MV", "ML", "MH", "FM", "NA", "NR", "NE", "PW", "PG", "WS", "SM", "ST", "SN", "SC", "SL", "SB", "KN", "LC", "VC", "SR", "TL", "TO", "TT", "TV", "VU", "AZ", "BN", "BI", "KH", "CM", "TD", "KM", "GQ", "SZ", "GA", "GN", "KG", "LA", "MO", "MR", "MN", "NP", "RW", "TG", "UZ", "ZW", "BJ", "MG", "MU", "MZ", "AO", "CI", "DJ", "ZM", "CD", "CG", "IQ", "LY", "TJ", "VE", "ET", "XK"], "external_urls": {"spotify": "https://open.spotify.com/album/0XGHAu5WoAKX5jhA2Oyfwf"}, "href": "https://api.spotify.com/v1/albums/0XGHAu5WoAKX5jhA2Oyfwf", "id": "0XGHAu5WoAKX5jhA2Oyfwf", "images": [{"height": 640, "url": "https://i.scdn.co/image/ab67616d0000b2733ad276259dfaa6b35f7b5650", "width": 640}, {"height": 300, "url": "https://i.scdn.co/image/ab67616d00001e023ad276259dfaa6b35f7b5650", "width": 300}, {"height": 64, "url": "https://i.scdn.co/image/ab67616d000048513ad276259dfaa6b35f7b5650", "width": 64}], "name": "Ariane", "release_date": "2023-11-17", "release_date_precision": "day", "total_tracks": 9, "type": "album", "uri": "spotify:album:0XGHAu5WoAKX5jhA2Oyfwf"}, "artists": [{"external_urls": {"spotify": "https://open.spotify.com/artist/48cu2msOlKJZfmTxeYLkuZ"}, "href": "https://api.spotify.com/v1/artists/48cu2msOlKJZfmTxeYLkuZ", "id": "48cu2msOlKJZfmTxeYLkuZ", "name": "ACHIM", "type": "artist", "uri": "spotify:artist:48cu2msOlKJZfmTxeYLkuZ"}], "available_markets": ["AR", "AU", "AT", "BE", "BO", "BR", "BG", "CA", "CL", "CO", "CR", "CY", "CZ", "DK", "DO", "DE", "EC", "EE", "SV", "FI", "FR", "GR", "GT", "HN", "HK", "HU", "IS", "IE", "IT", "LV", "LT", "LU", "MY", "MT", "MX", "NL", "NZ", "NI", "NO", "PA", "PY", "PE", "PH", "PL", "PT", "SG", "SK", "ES", "SE", "CH", "TW", "TR", "UY", "US", "GB", "AD", "LI", "MC", "ID", "JP", "TH", "VN", "RO", "IL", "ZA", "SA", "AE", "BH", "QA", "OM", "KW", "EG", "MA", "DZ", "TN", "LB", "JO", "PS", "IN", "BY", "KZ", "MD", "UA", "AL", "BA", "HR", "ME", "MK", "RS", "SI", "KR", "BD", "PK", "LK", "GH", "KE", "NG", "TZ", "UG", "AG", "AM", "BS", "BB", "BZ", "BT", "BW", "BF", "CV", "CW", "DM", "FJ", "GM", "GE", "GD", "GW", "GY", "HT", "JM", "KI", "LS", "LR", "MW", "MV", "ML", "MH", "FM", "NA", "NR", "NE", "PW", "PG", "WS", "SM", "ST", "SN", "SC", "SL", "SB", "KN", "LC", "VC", "SR", "TL", "TO", "TT", "TV", "VU", "AZ", "BN", "BI", "KH", "CM", "TD", "KM", "GQ", "SZ", "GA", "GN", "KG", "LA", "MO", "MR", "MN", "NP", "RW", "TG", "UZ", "ZW", "BJ", "MG", "MU", "MZ", "AO", "CI", "DJ", "ZM", "CD", "CG", "IQ", "LY", "TJ", "VE", "ET", "XK"], "disc_number": 1, "duration_ms": 134370, "explicit": true, "external_ids": {"isrc": "FR6NC2340540"}, "external_urls": {"spotify": "https://open.spotify.com/track/5BPuQVyyxHYX52ZDGfmaXr"}, "href": "https://api.spotify.com/v1/tracks/5BPuQVyyxHYX52ZDGfmaXr", "id": "5BPuQVyyxHYX52ZDGfmaXr", "is_local": false, "name": "modj", "popularity": 38, "preview_url": "https://p.scdn.co/mp3-preview/33a5a66ae6ce629742eb2aa300f9770e855def1f?cid=5d4637c1e36b4b88b2d8c53990a215f7", "track_number": 4, "type": "track", "uri": "spotify:track:5BPuQVyyxHYX52ZDGfmaXr"}}, {"added_at": "2024-01-05T16:46:42Z", "track": {"album": {"album_type": "album", "artists": [{"external_urls": {"spotify": "https://open.spotify.com/artist/0wiCfDEHaEcPkKZOi7Nivl"}, "href": "https://api.spotify.com/v1/artists/0wiCfDEHaEcPkKZOi7Nivl", "id": "0wiCfDEHaEcPkKZOi7Nivl", "name": "Yam\u00ea", "type": "artist", "uri": "spotify:artist:0wiCfDEHaEcPkKZOi7Nivl"}], "available_markets": ["AR", "AU", "AT", "BE", "BO", "BR", "BG", "CA", "CL", "CO", "CR", "CY", "CZ", "DK", "DO", "DE", "EC", "EE", "SV", "FI", "FR", "GR", "GT", "HN", "HK", "HU", "IS", "IE", "IT", "LV", "LT", "LU", "MY", "MT", "MX", "NL", "NZ", "NI", "NO", "PA", "PY", "PE", "PH", "PL", "PT", "SG", "SK", "ES", "SE", "CH", "TW", "TR", "UY", "US", "GB", "AD", "LI", "MC", "ID", "JP", "TH", "VN", "RO", "IL", "ZA", "SA", "AE", "BH", "QA", "OM", "KW", "EG", "MA", "DZ", "TN", "LB", "JO", "PS", "IN", "BY", "KZ", "MD", "UA", "AL", "BA", "HR", "ME", "MK", "RS", "SI", "KR", "BD", "PK", "LK", "GH", "KE", "NG", "TZ", "UG", "AG", "AM", "BS", "BB", "BZ", "BT", "BW", "BF", "CV", "CW", "DM", "FJ", "GM", "GE", "GD", "GW", "GY", "HT", "JM", "KI", "LS", "LR", "MW", "MV", "ML", "MH", "FM", "NA", "NR", "NE", "PW", "PG", "WS", "SM", "ST", "SN", "SC", "SL", "SB", "KN", "LC", "VC", "SR", "TL", "TO", "TT", "TV", "VU", "AZ", "BN", "BI", "KH", "CM", "TD", "KM", "GQ", "SZ", "GA", "GN", "KG", "LA", "MO", "MR", "MN", "NP", "RW", "TG", "UZ", "ZW", "BJ", "MG", "MU", "MZ", "AO", "CI", "DJ", "ZM", "CD", "CG", "IQ", "LY", "TJ", "VE", "ET", "XK"], "external_urls": {"spotify": "https://open.spotify.com/album/2UTCK04bnhvtwHv6omA7Xi"}, "href": "https://api.spotify.com/v1/albums/2UTCK04bnhvtwHv6omA7Xi", "id": "2UTCK04bnhvtwHv6omA7Xi", "images": [{"height": 640, "url": "https://i.scdn.co/image/ab67616d0000b2732de5d68844e0be4fddadd3ba", "width": 640}, {"height": 300, "url": "https://i.scdn.co/image/ab67616d00001e022de5d68844e0be4fddadd3ba", "width": 300}, {"height": 64, "url": "https://i.scdn.co/image/ab67616d000048512de5d68844e0be4fddadd3ba", "width": 64}], "name": "Agent 237", "release_date": "2021-06-04", "release_date_precision": "day", "total_tracks": 8, "type": "album", "uri": "spotify:album:2UTCK04bnhvtwHv6omA7Xi"}, "artists": [{"external_urls": {"spotify": "https://open.spotify.com/artist/0wiCfDEHaEcPkKZOi7Nivl"}, "href": "https://api.spotify.com/v1/artists/0wiCfDEHaEcPkKZOi7Nivl", "id": "0wiCfDEHaEcPkKZOi7Nivl", "name": "Yam\u00ea", "type": "artist", "uri": "spotify:artist:0wiCfDEHaEcPkKZOi7Nivl"}], "available_markets": ["AR", "AU", "AT", "BE", "BO", "BR", "BG", "CA", "CL", "CO", "CR", "CY", "CZ", "DK", "DO", "DE", "EC", "EE", "SV", "FI", "FR", "GR", "GT", "HN", "HK", "HU", "IS", "IE", "IT", "LV", "LT", "LU", "MY", "MT", "MX", "NL", "NZ", "NI", "NO", "PA", "PY", "PE", "PH", "PL", "PT", "SG", "SK", "ES", "SE", "CH", "TW", "TR", "UY", "US", "GB", "AD", "LI", "MC", "ID", "JP", "TH", "VN", "RO", "IL", "ZA", "SA", "AE", "BH", "QA", "OM", "KW", "EG", "MA", "DZ", "TN", "LB", "JO", "PS", "IN", "BY", "KZ", "MD", "UA", "AL", "BA", "HR", "ME", "MK", "RS", "SI", "KR", "BD", "PK", "LK", "GH", "KE", "NG", "TZ", "UG", "AG", "AM", "BS", "BB", "BZ", "BT", "BW", "BF", "CV", "CW", "DM", "FJ", "GM", "GE", "GD", "GW", "GY", "HT", "JM", "KI", "LS", "LR", "MW", "MV", "ML", "MH", "FM", "NA", "NR", "NE", "PW", "PG", "WS", "SM", "ST", "SN", "SC", "SL", "SB", "KN", "LC", "VC", "SR", "TL", "TO", "TT", "TV", "VU", "AZ", "BN", "BI", "KH", "CM", "TD", "KM", "GQ", "SZ", "GA", "GN", "KG", "LA", "MO", "MR", "MN", "NP", "RW", "TG", "UZ", "ZW", "BJ", "MG", "MU", "MZ", "AO", "CI", "DJ", "ZM", "CD", "CG", "IQ", "LY", "TJ", "VE", "ET", "XK"], "disc_number": 1, "duration_ms": 69474, "explicit": true, "external_ids": {"isrc": "QZHN92139343"}, "external_urls": {"spotify": "https://open.spotify.com/track/7oQWRMrJWozGJgSTL5sJKB"}, "href": "https://api.spotify.com/v1/tracks/7oQWRMrJWozGJgSTL5sJKB", "id": "7oQWRMrJWozGJgSTL5sJKB", "is_local": false, "name": "Carr\u00e9 d'as", "popularity": 60, "preview_url": "https://p.scdn.co/mp3-preview/601e74316d032322b202c0329845f090eff63b8d?cid=5d4637c1e36b4b88b2d8c53990a215f7", "track_number": 3, "type": "track", "uri": "spotify:track:7oQWRMrJWozGJgSTL5sJKB"}}, {"added_at": "2024-01-05T16:25:16Z", "track": {"album": {"album_type": "album", "artists": [{"external_urls": {"spotify": "https://open.spotify.com/artist/6dbdXbyAWk2qx8Qttw0knR"}, "href": "https://api.spotify.com/v1/artists/6dbdXbyAWk2qx8Qttw0knR", "id": "6dbdXbyAWk2qx8Qttw0knR", "name": "Josman", "type": "artist", "uri": "spotify:artist:6dbdXbyAWk2qx8Qttw0knR"}], "available_markets": ["AR", "AU", "AT", "BE", "BO", "BR", "BG", "CA", "CL", "CO", "CR", "CY", "CZ", "DK", "DO", "DE", "EC"
import json
import requests
from collections import Counter
from getNewToken import getNewToken
from getFavoriteTracks import getFavoriteTracks
import logging


def getAllTracksIDs():
    favorite_tracks = getFavoriteTracks()
    tracks = []
    for track in favorite_tracks:
        currentID = track["track"]["id"]
        tracks.append(currentID)
    return tracks


def getTopGenres():
    tracksIDs = getAllTracksIDs()
    token = getNewToken()
    headers = {"Authorization": f"Bearer {token}"}
    allGenresFeatures = []

    for trackID in tracksIDs:
        try:
            url = f"https://api.spotify.com/v1/audio-features/{trackID}"
            response = requests.get(url, headers=headers)
            data = response.json()
            allGenresFeatures.append(data)
            logging.info(allGenresFeatures)
        except Exception as e:
            logging.error(e)

    return allGenresFeatures
